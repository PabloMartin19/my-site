---
title: "Informática forense"
date: 2025-01-29 19:00:00 +0000
categories: [Seguridad, Análisis]
tags: [Análisis]
author: pablo
description: "En esta práctica realizaremos un análisis forense sobre un disco volcado en Windows 10 y Debian 12. La finalidad de esto es encontrar distintas pruebas sobre lo que estaba ocurriendo en ese momento en el disco, además de mucha información necesaria para recoger evidencias."
toc: true
comments: true
image:
  path: /assets/img/posts/forense/portada.jpg
---

La informática forense es el conjunto de técnicas que nos permite obtener la máxima información posible tras un incidente o delito informático.

En esta práctica, realizarás la fase de toma de evidencias y análisis de las mismas sobre una máquina Linux y otra Windows. Supondremos que pillamos al delincuente in fraganti y las máquinas se encontraban encendidas. Opcionalmente, podéis realizar el análisis de un dispositivo Android.

Sobre cada una de las máquinas debes realizar el proceso de toma de evidencias siguiendo las directrices contenidas en RFC 3227(incluyendo un volcado de memoria y otro de disco duro), tomando las medidas necesarias para certificar posteriormente la cadena de custodia.

## Apartado A) Máquina Windows

### Volcado de disco duro en Windows

Comenzaremos realizando un volcado de disco duro en Windows, en concreto una máquina virtual con 30GB de disco. Este disco tiene registros e información necesarios para el caso práctico, pero tendremos que añadir otro disco del doble de tamaño (60GB) para hacer allí el volcado de información.

Algo muy a tener en cuenta es que estamos trabajando sobre un entorno que no es real, además, del poco tiempo para realizar la práctica. Por lo que lo recomendable es utilizar un disco cuanto más pequeño mejor, ya que de lo contrario puede tardar días en realizar el análisis. Evidentemente en un caso real pues los discos estarían mucho más llenos y el proceso tardaría más, pero en este caso lo haré así.

El volcado del disco duro con **FTK Imager** crea una copia exacta del almacenamiento de la máquina sin alterar su contenido. Esta imagen contiene todos los datos del sistema, incluyendo archivos, registros del sistema, historial de actividad y posibles rastros de malware. Este proceso es fundamental en el análisis forense, ya que permite examinar el estado del disco en un entorno seguro sin modificar la evidencia original.

Una vez dicho esto, tendremos que instalar la herramienta que utilizaremos para el volcado, existen muchas pero yo me he decantado por [AccessData FTK Imager](https://www.exterro.com/ftk-product-downloads/ftk-imager-4-7-3-81).

Después de instalarlo accedemos a la aplicación y comenzamos con el volcado, para ello seguimos los siguientes pasos:

1. Primero de todo le damos a "File" y seleccionamos la opción "Create Disk Image..."

    ![image](/assets/img/posts/forense/image1.png)

2. Elegimos como origen el disco físico de la máquina virtual, lo que nos permite capturar una copia exacta de su contenido.

    ![image](/assets/img/posts/forense/image2.png)

3. Seleccionamos ahora el disco desde el cual haremos el volcado.

    ![image](/assets/img/posts/forense/image3.png)

4. En este paso tendremos que especificar donde se va a realizar el volcado, para ello seleccionamos la opción "Add...", luego la primera opción Raw (dd), en la siguiente pestaña rellenamos datos meramente informativos y por último, elegimos el disco de destino donde se hará el volcado de datos.

    ![image](/assets/img/posts/forense/image4.png)

    ![image](/assets/img/posts/forense/image5.png)
    
    ![image](/assets/img/posts/forense/image6.png)

    ![image](/assets/img/posts/forense/image7.png)

5. Una vez configurado donde se realizará el volcado le damos a "Start".

    ![image](/assets/img/posts/forense/image8.png)


6. En donde nos saldrá una pestaña así con un progreso, el cual tardará unos 10 minutos.

    ![image](/assets/img/posts/forense/image9.png)

7. Durante el proceso también nos saldrá a lo último una verificación.

    ![image](/assets/img/posts/forense/image10.png)

8. Una vez terminado el volcado nos saldrá una pestaña con varios detalles, incluido el hash.

    ![image](/assets/img/posts/forense/image11.png)

9. También esta pestaña con una recopilación del volcado.

    ![image](/assets/img/posts/forense/image12.png)


Bien, pues ya habríamos terminado de esta forma el volcado de disco, para corroborar que se ha realizado con éxito nos podemos dirigir a "Archivos" y ver que el nuevo disco (Nuevo Vol (E:)) se ha llenado de información:

![image](/assets/img/posts/forense/image13.png)

Si accedemos a los archivos del disco donde hemos hecho el volcado, podemos ver todos estos ficheros:

![image](/assets/img/posts/forense/image14.png)

Básicamente lo que hace es fragmentar el disco en varios archivos para así poder dividir la imagen en partes más manejables. Esto es especialmente útil si el disco de destino tiene restricciones de tamaño de archivo.

### Volcado de memoria en Windows

Para el volcado de memoria utilizaré la misma herramienta que anteriormente, pues es un proceso muy sencillo y similar al de disco. 

Primero de todo seleccionamos de nuevo en "File" y pulsamos en "Capture Memory...".

![image](/assets/img/posts/forense/image15.png)

Nos saldrá una ventana en donde tendremos que seleccionar el disco E: como destino, además de marcar la casilla "Include page file".

![image](/assets/img/posts/forense/image16.png)

Le damos a "Capture Memory" y comenzará el proceso:

![image](/assets/img/posts/forense/image17.png)

Una vez terminado nos dirigimos de nuevo al disco para corroborar que se ha añadido los ficheros del volcado:

![image](/assets/img/posts/forense/image18.png)

### Volcado de registros en Windows

Ahora realizaré un volcado de registro, el cual consiste en extraer las bases de datos del Registro de Windows, donde se almacenan configuraciones del sistema, historial de actividad, credenciales y rastros de software o malware. 

Para ello, usamos la misma herramienta que los dos caso anteriores. En donde le tendremos que dar al icono amarillo de arriba:

![image](/assets/img/posts/forense/image19.png)

Se abrirá una pestaña y ahí tendremos que especificar la ruta del disco de destino, el cual es el mismo que en las dos anteriores:

![image](/assets/img/posts/forense/image20.png)

Comenzará el volcado de registro y una vez terminado, volvemos de nuevo al disco E: y vemos como se han generado nuevos ficheros:

![image](/assets/img/posts/forense/image21.png)

### Análisis disco con Autopsy

Una vez realizados los volcados del disco, memoria y registros, procederemos con el análisis forense utilizando [Autopsy](https://www.autopsy.com/download/). Autopsy es una herramienta gráfica que facilita la investigación y análisis de las evidencias recogidas, como las imágenes de disco, volcados de memoria y registros.

Una vez realizada la instalación, accedemos a la aplicación y nos saldrán diferentes opciones, nosotros marcamos "New Case":

![image](/assets/img/posts/forense/image22.png)

En la siguiente pestaña le damos un nombre al Caso y elegimos donde se guardará:

![image](/assets/img/posts/forense/image23.png)

En el siguiente paso rellenamos los datos meramente informativos:

![image](/assets/img/posts/forense/image24.png)

Una vez que hayamos creado el caso en Autopsy, la herramienta generará una base de datos que servirá como su estructura principal para el análisis. 

El siguiente paso será elegir la fuente de datos desde la cual se recopilará la información.

![image](/assets/img/posts/forense/image25.png)

Esta pestaña es muy importante, pues solo marcaremos las opciones que nos interesan, pues de lo contrario hará que el análisis tarde mucho más. Las opciones que yo he marcado son las siguientes:

![image](/assets/img/posts/forense/image26.png)

Le damos a "Finish" y en ese preciso momento comenzará el análisis:

![image](/assets/img/posts/forense/image27.png)

Como vemos se está empezando a recopilar información, este proceso puede tardar mucho dependiendo de muchas variables. En mi caso lo paré al 35% después de unas 4-5 horas, pues con lo que había recopilado ya era suficiente para lo que nos pide la práctica. 

![image](/assets/img/posts/forense/image28.png)


### Instalación Volatility3 en Debian 12

Volatility es una herramienta de análisis forense de memoria RAM que permite extraer información de volcados de memoria de sistemas Windows, Linux y macOS. Se usa para investigar incidentes de seguridad, detectar malware, recuperar datos y analizar procesos en ejecución. 

Por lo tanto, procedemos a su instalación la cual tendremos que bajarnos desde el repositorio:

```bash
pavlo@debian:~()$ git clone https://github.com/volatilityfoundation/volatility3.git
Clonando en 'volatility3'...
remote: Enumerating objects: 42556, done.
remote: Counting objects: 100% (346/346), done.
remote: Compressing objects: 100% (168/168), done.
remote: Total 42556 (delta 281), reused 195 (delta 178), pack-reused 42210 (from 3)
Recibiendo objetos: 100% (42556/42556), 8.38 MiB | 15.93 MiB/s, listo.
Resolviendo deltas: 100% (32743/32743), listo.
```

Accedemos al directorio del repositorio clonado y creamos un entorno virtual de Python para aislar la instalación:

```bash
pavlo@debian:~()$ cd volatility3/
pavlo@debian:~/volatility3(develop)$ python3 -m venv venv
pavlo@debian:~/volatility3(develop)$ source venv/bin/activate
```

En este punto, Volatility 3 no incluye un `requirements.txt`, ya que usa `pyproject.toml` para gestionar dependencias, por lo que ejecutamos el siguiente comando para la instalación: 

```bash
(venv) pavlo@debian:~/volatility3(develop)$ pip install .
Processing /home/pavlo/volatility3
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Collecting pefile>=2024.8.26
  Downloading pefile-2024.8.26-py3-none-any.whl (74 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 74.8/74.8 kB 734.5 kB/s eta 0:00:00
Building wheels for collected packages: volatility3
  Building wheel for volatility3 (pyproject.toml) ... done
  Created wheel for volatility3: filename=volatility3-2.20.1-py3-none-any.whl size=912249 sha256=e2fe6f191532e493cc5e305d706c26e69f569b60bba6a6ff55bf73cf5e8f1760
  Stored in directory: /tmp/pip-ephem-wheel-cache-oo31pspy/wheels/5f/87/74/6ce43180018f0afedce648bb9388f6ff390d38822e323a4083
Successfully built volatility3
Installing collected packages: pefile, volatility3
Successfully installed pefile-2024.8.26 volatility3-2.20.1
```

Para comprobar que la instalación fue exitosa, ejecutamos el siguiente comando:

```bash
(venv) pavlo@debian:~/volatility3(develop)$ python3 vol.py -h
Volatility 3 Framework 2.20.1
usage: vol.py [-h] [-c CONFIG] [--parallelism [{processes,threads,off}]] [-e EXTEND] [-p PLUGIN_DIRS] [-s SYMBOL_DIRS] [-v] [-l LOG] [-o OUTPUT_DIR] [-q] [-r RENDERER]
              [-f FILE] [--write-config] [--save-config SAVE_CONFIG] [--clear-cache] [--cache-path CACHE_PATH] [--offline | -u URL] [--filters FILTERS]
              [--hide-columns [HIDE_COLUMNS ...]] [--single-location SINGLE_LOCATION] [--stackers [STACKERS ...]] [--single-swap-locations [SINGLE_SWAP_LOCATIONS ...]]
              PLUGIN ...
```

### Montaje del disco de Windows en Debian

Para la realización de las comprobaciones, necesitaremos utilizar distintas herramientas y entre ellas Volatility, la cual instalamos anteriormente. Por lo tanto, tendremos que montar el disco de Windows con el volcado en nuestra máquina física, el cual se encuentra en la ruta `/var/lib/libvirt/images/win10-1.qcow2`. Para ello seguiremos los siguientes pasos:

Primero, cargamos el módulo necesario para manejar discos en red con el siguiente comando:

```bash
(venv) pavlo@debian:~()$ sudo modprobe nbd
```

Luego, conectamos el archivo de imagen del disco virtual (en formato qcow2) a un dispositivo de bloque, utilizando qemu-nbd:

```bash
(venv) pavlo@debian:~()$ sudo qemu-nbd --connect=/dev/nbd0 /var/lib/libvirt/images/win10-1.qcow2
```

A continuación, listamos las particiones del disco con fdisk -l para verificar la estructura del disco y las particiones disponibles:

```bash
(venv) pavlo@debian:~()$ sudo fdisk -l /dev/nbd0
Disco /dev/nbd0: 60 GiB, 64424509440 bytes, 125829120 sectores
Unidades: sectores de 1 * 512 = 512 bytes
Tamaño de sector (lógico/físico): 512 bytes / 512 bytes
Tamaño de E/S (mínimo/óptimo): 512 bytes / 512 bytes
Tipo de etiqueta de disco: gpt
Identificador del disco: 479ABFDB-206B-403A-AF13-FEB3282C2C41

Disposit.   Comienzo     Final  Sectores Tamaño Tipo
/dev/nbd0p1       34     32767     32734    16M Reservado para Microsoft
/dev/nbd0p2    32768 125825023 125792256    60G Datos básicos de Microsoft
```

Esto nos muestra las particiones del disco, donde identificamos la partición de datos del sistema operativo. Posteriormente, creamos un directorio para montar la partición y proceder con el análisis:

```bash
(venv) pavlo@debian:~()$ sudo mkdir -p /mnt/windows
```

Montamos la partición de datos del disco en modo solo lectura:

```bash
(venv) pavlo@debian:~()$ sudo mount -o ro /dev/nbd0p2 /mnt/windows/
```

Ya montada la partición, podemos verificar que los archivos del sistema y los volcados de memoria están presentes con el comando:

```bash
(venv) pavlo@debian:~()$ ls /mnt/windows/
'$RECYCLE.BIN'       SAM                          Users                  VolcadoDisco.004   VolcadoDisco.009   VolcadoDisco.014   VolcadoDisco.019
 default             SECURITY                     VolcadoDisco.001       VolcadoDisco.005   VolcadoDisco.010   VolcadoDisco.015   VolcadoDisco.020
 DumpStack.log.tmp   software                     VolcadoDisco.001.txt   VolcadoDisco.006   VolcadoDisco.011   VolcadoDisco.016   VolcadoDisco.021
 memdump.mem         system                       VolcadoDisco.002       VolcadoDisco.007   VolcadoDisco.012   VolcadoDisco.017
 pagefile.sys       'System Volume Information'   VolcadoDisco.003       VolcadoDisco.008   VolcadoDisco.013   VolcadoDisco.018
```

Una vez que tenemos acceso al volcado de memoria (memdump.mem), utilizamos Volatility para analizarlo, ejecutando el siguiente comando:

```bash
(venv) pavlo@debian:~/volatility3(develop)$ python3 vol.py -f "/mnt/windows/memdump.mem" windows.info
Volatility 3 Framework 2.20.1
Progress:  100.00		PDB scanning finished                                                                                              
Variable	Value

Kernel Base	0xf8012be00000
DTB	0x1ad000
Symbols	file:///home/pavlo/volatility3/volatility3/symbols/windows/ntkrnlmp.pdb/89284D0CA6ACC8274B9A44BD5AF9290B-1.json.xz
Is64Bit	True
IsPAE	False
layer_name	0 WindowsIntel32e
memory_layer	1 FileLayer
KdVersionBlock	0xf8012ca0f3a0
Major/Minor	15.19041
MachineType	34404
KeNumberProcessors	2
SystemTime	2025-02-12 10:49:55+00:00
NtSystemRoot	C:\Windows
NtProductType	NtProductWinNt
NtMajorVersion	10
NtMinorVersion	0
PE MajorOperatingSystemVersion	10
PE MinorOperatingSystemVersion	0
PE Machine	34404
PE TimeDateStamp	Fri May 20 08:24:42 2101
```

### Comprobaciones

Para las siguiente comprobaciones utilizaré Volatility, CMD, PowerShell y RegistryViewer.

1. Procesos en ejecución.

    Con `PsList` enumeramos los procesos del sistema en el momento que se tomó el volcado de la memoria. Cada fila representa un proceso en el sistema, mostrando su ID, la ID del proceso padre, nombre de archivo, sesión, etc.

    ```bash
    python3 vol.py -f "/mnt/windows/memdump.mem" windows.pslist.PsList
    ```

    ![image](/assets/img/posts/forense/image30.png)

2. Servicios en ejecución.

    Mostramos una lista de servicios en el sistema, indicador y nombre del servicio:

    ```bash
    python vol.py -f "/mnt/windows/memdump.mem" windows.getservicesids.GetServiceSIDs
    ```

    ![image](/assets/img/posts/forense/image31.png)

3. Puertos abiertos.

    Muestra las conexiones de red actualmente establecidas, incluyendo los puertos en uso, las direcciones IP de origen y destino, los identificadores de proceso (PID) asociados y las marcas de tiempo correspondientes.

    ```bash
    python vol.py -f "/mnt/windows/memdump.mem" windows.netstat.NetStat
    ```

    ![image](/assets/img/posts/forense/image32.png)

4. Conexiones establecidas por la máquina.

    Muestra las conexiones de red activas en la máquina, incluyendo los protocolos utilizados, las direcciones IP de origen y destino, los puertos implicados, el estado de cada conexión, el usuario propietario y el identificador del proceso asociado.

    ```bash
    python vol.py -f "/mnt/forense/windows/memoria/memdump.mem" windows.netscan.NetScan
    ```

    ![image](/assets/img/posts/forense/image33.png)

5. Sesiones de usuario establecidas remotamente.

    Presenta las sesiones activas en el sistema en el instante en que se realizó el volcado, incluyendo la identificación de la sesión, su tipo, el identificador y nombre del proceso asociado, el usuario que la inició y la marca temporal correspondiente.

    ```bash
    python vol.py -f "/mnt/windows/memdump.mem" windows.sessions.Sessions
    ```

    ![image](/assets/img/posts/forense/image34.png)

6. Ficheros transferidos recientemente por NetBios.

    Dado que ni Autopsy ni Volatility ofrecen opciones directas para visualizar los archivos transferidos mediante NetBIOS, ejecutaremos el comando `nbtstat -n` en la misma máquina. Este comando nos permitirá ver la tabla de NetBIOS local en los adaptadores de red, mostrando los nombres registrados y su estado en la red.

    ![image](/assets/img/posts/forense/image36.png)

7. Contenido de la caché DNS.

    Ejecutaremos el comando `ipconfig /displaydns`, el cual nos permitirá visualizar los nombres de dominio y hosts que han sido resueltos recientemente, junto con sus direcciones IP correspondientes. Esta información puede ser útil para analizar conexiones previas establecidas por el sistema.

    ![image](/assets/img/posts/forense/image37.png)

8. Variables de entorno.

    Expondremos las variables de entorno del sistema en el momento del volcado, detallando el identificador y nombre del proceso asociado, la ubicación en memoria, el nombre de la variable y su valor correspondiente.

    ```bash
    python vol.py -f "/mnt/forense/windows/memoria/memdump.mem" windows.envars.Envars
    ```

    ![image](/assets/img/posts/forense/image35.png)

9. Dispositivos USB conectados

    En Autopsy, utilizando la opción **USB Device Attached**, podremos visualizar los dispositivos USB extraíbles que han sido conectados a la máquina en algún momento.

    ![image](/assets/img/posts/forense/image38.png)

10. Redes wifi utilizadas recientemente.

    Utilizando la herramienta **Registry Viewer**, podemos analizar el archivo **system** del registro de Windows y navegar hasta la ruta `system/ControlSet001/Control/Network/Connections`. En esta ubicación, encontramos claves del registro que contienen información sobre las redes Wi-Fi a las que se ha conectado la máquina.  

    ![image](/assets/img/posts/forense/image39.png)

11. Configuración del firewall de nodo.

    Para examinar la configuración de las reglas del firewall, utilizaremos Registry Viewer y abriremos el archivo system. Luego, navegaremos hasta la ruta:

    ```bash
    system\ControlSet001\Services\SharedAccess\Defaults\FirewallPolicy\FirewallRules
    ```

    Aquí encontraremos diversas reglas del firewall almacenadas en el registro de Windows. Por ejemplo, una regla destacada podría ser:

    ![image](/assets/img/posts/forense/image40.png)

12. Programas que se ejecutan en el Inicio.

    Abrimos nuevamente el archivo **software** y navegamos hasta la ruta:  

    `software\Microsoft\Windows\CurrentVersion\Run`  

    Aquí podemos ver los programas configurados para ejecutarse automáticamente al iniciar el sistema. En este caso, solo encontramos un antivirus integrado en el sistema que se inicia con Windows. Esta clave del registro es útil para identificar programas que se ejecutan al inicio, lo que puede ayudar en la detección de posibles **malware** o herramientas de administración remota ocultas.

    ![image](/assets/img/posts/forense/image41.png)

13. Asociación de extensiones de ficheros y aplicaciones.

    En el desplegable File Types, encontraremos una lista de diversas extensiones de archivo.

    ![image](/assets/img/posts/forense/image42.png)

    ![image](/assets/img/posts/forense/image43.png)

14. Aplicaciones usadas recientemente.

    Para ver las aplicaciones que se han utilizado en el sistema, podemos dirigirnos al artefacto **Run Programs**. 

    ![image](/assets/img/posts/forense/image44.png)

    Otra forma de ver las aplicaciones utilizadas es acceder al archivo de volcado del disco (dump) en la pestaña `Summary`, específicamente en la sección `User Activity`.

    ![image](/assets/img/posts/forense/image45.png)

15. Ficheros abiertos recientemente.

    Podemos verlo en el apartado **Recent Documents**.

    ![image](/assets/img/posts/forense/image46.png)

16. Software Instalado.

    Podemos ver el software instalado en el artefacto **Installed Programs**.

    ![image](/assets/img/posts/forense/image47.png)

17. Contraseñas guardadas.

    Las contraseñas guardadas las podemos ver en **Web Account Type**.

    ![image](/assets/img/posts/forense/image48.png)

18. Cuentas de Usuario

    Para ver las cuentas en **OS Accounts**.

    ![image](/assets/img/posts/forense/image49.png)

19. Historial de navegación y descargas. Cookies.

    Para ver el historial de navegación iremos a **Web History**.

    ![image](/assets/img/posts/forense/image50.png)

    Para ver las búsquedas en **Web Search**.

    ![image](/assets/img/posts/forense/image51.png)

    Las descargas en **Web Downloads**.

    ![image](/assets/img/posts/forense/image52.png)

    Las cookies en **Web Cookies**.

    ![image](/assets/img/posts/forense/image53.png)

20. Volúmenes cifrados

    Podemos verlos en la sección **Encryption Suspected**.

    ![image](/assets/img/posts/forense/image54.png)

21. Archivos con extensión cambiada.

    Para identificar los archivos que tienen una extensión cambiada o no adecuada, podemos acceder a la sección **Extension Mismatch Detected**.

    ![image](/assets/img/posts/forense/image55.png)

22. Archivos eliminados.

    Podemos ver los archivos eliminados en la sección **File Views** >> **Deleted Files** >> **File System**.

    ![image](/assets/img/posts/forense/image56.png)

23. Archivos Ocultos.

    Para encontrar los archivos **Hidden** debemos seleccionar justo el fichero y fijarnos en las Flags, donde indicará si está oculto o no:

    ![image](/assets/img/posts/forense/image57.png)

24. Archivos que contienen una cadena determinada.

    Para buscar una cadena debemos escribir la/s palabra/s en cuestión dentro de **Keyword Search**.

    ![image](/assets/img/posts/forense/image58.png)

25. Búsqueda de imágenes por ubicación.

    Para ver la ubicación de la imagen nos dirigimos al apartado **Geolocation** de arriba. Ahí nos movemos hacia la flecha y si pinchamos nos saldrá la imagen. 

    ![image](/assets/img/posts/forense/image60.png) 

    ![image](/assets/img/posts/forense/image59.png)

26. Búsqueda de archivos por autor.

    Para los archivos por autor vamos al artefacto **Metadata** y podemos ver que aparecen diferentes archivos y podemos ver el autor en el apartado de **Owner**.

    ![image](/assets/img/posts/forense/image61.png)


## Apartado B) Máquina Linux

### Volcado de disco duro

Tenemos un disco `vda` de 20GB que contiene el sistema operativo, y `vdb` de 40GB que utilizaremos para almacenar el volcado. 

```bash
pablo@forense:~$ lsblk
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
sr0     11:0    1 1024M  0 rom  
vda    254:0    0   20G  0 disk 
├─vda1 254:1    0   19G  0 part /
├─vda2 254:2    0    1K  0 part 
└─vda5 254:5    0  975M  0 part [SWAP]
vdb    254:16   0   40G  0 disk 
```

Dado que vdb es un disco nuevo sin particiones, primero le asignamos una tabla de particiones GPT:

```bash
pablo@forense:~$ sudo parted /dev/vdb -- mklabel gpt
Information: You may need to update /etc/fstab.
```

Luego, creamos una partición primaria que ocupará todo el espacio disponible y la formateamos con ext4:

```bash
pablo@forense:~$ sudo parted /dev/vdb -- mkpart primary ext4 1MiB 100%    
Information: You may need to update /etc/fstab.
pablo@forense:~$ sudo mkfs.ext4 /dev/vdb1
mke2fs 1.47.0 (5-Feb-2023)
Discarding device blocks: done                            
Creating filesystem with 10485248 4k blocks and 2621440 inodes
Filesystem UUID: b125a5f4-a782-43db-893b-e1ac045d71b8
Superblock backups stored on blocks: 
	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, 
	4096000, 7962624

Allocating group tables: done                            
Writing inode tables: done                            
Creating journal (65536 blocks): done
Writing superblocks and filesystem accounting information: done   
```

Para poder escribir en la nueva partición, la montamos en un directorio específico:

```bash
pablo@forense:~$ sudo mkdir -p /mnt/nuevo
pablo@forense:~$ sudo mount /dev/vdb1 /mnt/nuevo
```

El siguiente paso es realizar el volcado del disco `vda` hacia un archivo de imagen en `vdb`. 
Para ello, usamos dd, una herramienta que copia datos a nivel de bytes:

```bash
pablo@forense:~$ sudo dd if=/dev/vda of=/mnt/nuevo/discodebian.img bs=64K status=progress
21441085440 bytes (21 GB, 20 GiB) copied, 459 s, 46,7 MB/s 
327680+0 records in
327680+0 records out
21474836480 bytes (21 GB, 20 GiB) copied, 459,091 s, 46,8 MB/s
```

Verificamos que la imagen se ha creado correctamente y que el disco `vdb1` sigue montado:

```bash
pablo@forense:~$ lsblk
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
sr0     11:0    1 1024M  0 rom  
vda    254:0    0   20G  0 disk 
├─vda1 254:1    0   19G  0 part /
├─vda2 254:2    0    1K  0 part 
└─vda5 254:5    0  975M  0 part [SWAP]
vdb    254:16   0   40G  0 disk 
└─vdb1 254:17   0   40G  0 part /mnt/nuevo
```

### Volcado de memoria

Lo primero que hacemos es clonar el repositorio de LiME desde GitHub para obtener su código fuente:

```bash
pablo@forense:~$ git clone https://github.com/504ensicsLabs/LiME.git
Clonando en 'LiME'...
remote: Enumerating objects: 389, done.
remote: Counting objects: 100% (40/40), done.
remote: Compressing objects: 100% (26/26), done.
remote: Total 389 (delta 20), reused 28 (delta 14), pack-reused 349 (from 1)
Recibiendo objetos: 100% (389/389), 1.62 MiB | 3.09 MiB/s, listo.
Resolviendo deltas: 100% (209/209), listo.
```

Una vez completada la descarga, instalamos el paquete **lime-forensics-dkms** con APT, que nos facilita la compilación del módulo necesario para el volcado de memoria:

```bash
pablo@forense:~$ sudo apt install lime-forensics-dkms -y
```

Después de instalar las dependencias necesarias, accedemos al directorio donde se encuentra el código fuente y compilamos el módulo de LiME:

```bash
pablo@forense:~/LiME/src$ make
make -C /lib/modules/6.1.0-31-amd64/build M="/home/pablo/LiME/src" modules
make[1]: se entra en el directorio '/usr/src/linux-headers-6.1.0-31-amd64'
  CC [M]  /home/pablo/LiME/src/tcp.o
  CC [M]  /home/pablo/LiME/src/disk.o
  CC [M]  /home/pablo/LiME/src/main.o
  CC [M]  /home/pablo/LiME/src/hash.o
  CC [M]  /home/pablo/LiME/src/deflate.o
  LD [M]  /home/pablo/LiME/src/lime.o
  MODPOST /home/pablo/LiME/src/Module.symvers
  CC [M]  /home/pablo/LiME/src/lime.mod.o
  LD [M]  /home/pablo/LiME/src/lime.ko
  BTF [M] /home/pablo/LiME/src/lime.ko
Skipping BTF generation for /home/pablo/LiME/src/lime.ko due to unavailability of vmlinux
make[1]: se sale del directorio '/usr/src/linux-headers-6.1.0-31-amd64'
strip --strip-unneeded lime.ko
mv lime.ko lime-6.1.0-31-amd64.ko
```

Este proceso genera un módulo de kernel con el nombre lime.ko, que nos permitirá capturar la memoria volcada.

Para proceder con el volcado de memoria, insertamos el módulo en el kernel con la siguiente instrucción:

```bash
pablo@forense:~/LiME/src$ sudo insmod lime-6.1.0-31-amd64.ko "path=/mnt/nuevo/memdump.mem format=lime"
```

Una vez finalizado el proceso, comprobamos que el archivo se ha generado correctamente listando el contenido del directorio de destino:

```bash
pablo@forense:~/LiME/src$ ls -l /mnt/nuevo/
total 23068152
-rw-r--r-- 1 root root 21474836480 feb 14 08:46 discodebian.img
drwx------ 2 root root       16384 feb 14 08:37 lost+found
-r--r--r-- 1 root root  2146925632 feb 14 08:52 memdump.mem
```

El resultado nos muestra que el archivo `memdump.mem` ha sido creado con éxito, junto con la imagen del disco que volcamos previamente.

Para garantizar la integridad del volcado, generamos su hash SHA-256 con el siguiente comando:

```bash
pablo@forense:~$ sudo find /mnt/nuevo -type f -exec sha256sum {} +
93ee746af8ca6a4ebaf5e38f215b848fd5e6319d93c7bba9a72d8039e4d0c0fc  /mnt/nuevo/memdump.mem
de77108bcc533bfc9125cc54d60927cd2d687d5e1f8f316713ca35b9f3a5fb67  /mnt/nuevo/discodebian.img
```

Esto nos proporciona un hash único que nos permitirá verificar en el futuro que el archivo no ha sido modificado.


### Comprobaciones

No he sido capaz de realizar el volcado correctamente con Volatility, pues no lo reconocía. Además, tampoco he conseguido que Autopsy me funciones correctamente en Debian. Por lo tanto, no me queda otra que hacer las comprobaciones a través de la terminal.


1. Procesos en ejecución.

    ```bash
    pablo@forense:~$ ps -aux
    USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
    root           1  1.7  0.6 168172 12536 ?        Ss   08:57   0:00 /sbin/init
    root           2  0.0  0.0      0     0 ?        S    08:57   0:00 [kthreadd]
    root           3  0.0  0.0      0     0 ?        I<   08:57   0:00 [rcu_gp]
    root           4  0.0  0.0      0     0 ?        I<   08:57   0:00 [rcu_par_gp]
    root           5  0.0  0.0      0     0 ?        I<   08:57   0:00 [slub_flushwq]
    root           6  0.0  0.0      0     0 ?        I<   08:57   0:00 [netns]
    root           7  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/0:0-events]
    root           8  0.0  0.0      0     0 ?        I<   08:57   0:00 [kworker/0:0H-events_highpri]
    root           9  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/u4:0-events_unbound]
    root          10  0.0  0.0      0     0 ?        I<   08:57   0:00 [mm_percpu_wq]
    root          11  0.0  0.0      0     0 ?        I    08:57   0:00 [rcu_tasks_kthread]
    root          12  0.0  0.0      0     0 ?        I    08:57   0:00 [rcu_tasks_rude_kthread]
    root          13  0.0  0.0      0     0 ?        I    08:57   0:00 [rcu_tasks_trace_kthread]
    root          14  0.0  0.0      0     0 ?        S    08:57   0:00 [ksoftirqd/0]
    root          15  0.0  0.0      0     0 ?        I    08:57   0:00 [rcu_preempt]
    root          16  0.0  0.0      0     0 ?        S    08:57   0:00 [migration/0]
    root          17  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/0:1-events]
    root          18  0.0  0.0      0     0 ?        S    08:57   0:00 [cpuhp/0]
    root          19  0.0  0.0      0     0 ?        S    08:57   0:00 [cpuhp/1]
    root          20  0.0  0.0      0     0 ?        S    08:57   0:00 [migration/1]
    root          21  0.0  0.0      0     0 ?        S    08:57   0:00 [ksoftirqd/1]
    root          22  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/1:0-events]
    root          23  0.0  0.0      0     0 ?        I<   08:57   0:00 [kworker/1:0H-kblockd]
    root          25  0.6  0.0      0     0 ?        I    08:57   0:00 [kworker/u4:1-events_unbound]
    root          26  0.0  0.0      0     0 ?        S    08:57   0:00 [kdevtmpfs]
    root          27  0.0  0.0      0     0 ?        I<   08:57   0:00 [inet_frag_wq]
    root          28  0.0  0.0      0     0 ?        S    08:57   0:00 [kauditd]
    root          29  0.0  0.0      0     0 ?        S    08:57   0:00 [khungtaskd]
    root          30  0.0  0.0      0     0 ?        S    08:57   0:00 [oom_reaper]
    root          31  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/u4:2-events_unbound]
    root          32  0.0  0.0      0     0 ?        I<   08:57   0:00 [writeback]
    root          33  0.0  0.0      0     0 ?        S    08:57   0:00 [kcompactd0]
    root          34  0.0  0.0      0     0 ?        SN   08:57   0:00 [ksmd]
    root          35  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/1:1-events_power_efficient]
    root          36  0.0  0.0      0     0 ?        SN   08:57   0:00 [khugepaged]
    root          37  0.0  0.0      0     0 ?        I<   08:57   0:00 [kintegrityd]
    root          38  0.0  0.0      0     0 ?        I<   08:57   0:00 [kblockd]
    root          39  0.0  0.0      0     0 ?        I<   08:57   0:00 [blkcg_punt_bio]
    root          40  0.0  0.0      0     0 ?        I<   08:57   0:00 [tpm_dev_wq]
    root          41  0.0  0.0      0     0 ?        I<   08:57   0:00 [edac-poller]
    root          42  0.0  0.0      0     0 ?        I<   08:57   0:00 [devfreq_wq]
    root          43  0.0  0.0      0     0 ?        I<   08:57   0:00 [kworker/1:1H-kblockd]
    root          44  0.0  0.0      0     0 ?        S    08:57   0:00 [kswapd0]
    root          50  0.0  0.0      0     0 ?        I<   08:57   0:00 [kthrotld]
    root          52  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/24-aerdrv]
    root          53  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/25-aerdrv]
    root          54  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/26-aerdrv]
    root          55  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/27-aerdrv]
    root          56  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/28-aerdrv]
    root          57  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/29-aerdrv]
    root          58  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/30-aerdrv]
    root          59  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/31-aerdrv]
    root          60  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/32-aerdrv]
    root          61  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/33-aerdrv]
    root          62  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/34-aerdrv]
    root          63  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/35-aerdrv]
    root          64  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/36-aerdrv]
    root          65  0.0  0.0      0     0 ?        S    08:57   0:00 [irq/37-aerdrv]
    root          66  0.0  0.0      0     0 ?        I<   08:57   0:00 [acpi_thermal_pm]
    root          67  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/1:2-cgroup_destroy]
    root          68  0.0  0.0      0     0 ?        I<   08:57   0:00 [mld]
    root          69  0.0  0.0      0     0 ?        I<   08:57   0:00 [ipv6_addrconf]
    root          74  0.0  0.0      0     0 ?        I<   08:57   0:00 [kstrp]
    root          79  0.0  0.0      0     0 ?        I<   08:57   0:00 [zswap-shrink]
    root          80  0.0  0.0      0     0 ?        I<   08:57   0:00 [kworker/u5:0]
    root         140  0.0  0.0      0     0 ?        I<   08:57   0:00 [kworker/0:1H-kblockd]
    root         143  0.0  0.0      0     0 ?        I<   08:57   0:00 [ata_sff]
    root         145  0.0  0.0      0     0 ?        S    08:57   0:00 [scsi_eh_0]
    root         147  0.0  0.0      0     0 ?        I<   08:57   0:00 [scsi_tmf_0]
    root         148  0.0  0.0      0     0 ?        S    08:57   0:00 [scsi_eh_1]
    root         149  0.0  0.0      0     0 ?        I<   08:57   0:00 [scsi_tmf_1]
    root         150  0.0  0.0      0     0 ?        S    08:57   0:00 [scsi_eh_2]
    root         151  0.0  0.0      0     0 ?        I<   08:57   0:00 [scsi_tmf_2]
    root         152  0.0  0.0      0     0 ?        S    08:57   0:00 [scsi_eh_3]
    root         153  0.0  0.0      0     0 ?        I<   08:57   0:00 [scsi_tmf_3]
    root         154  0.0  0.0      0     0 ?        S    08:57   0:00 [scsi_eh_4]
    root         155  0.0  0.0      0     0 ?        S    08:57   0:00 [scsi_eh_5]
    root         156  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/0:2-events]
    root         157  0.0  0.0      0     0 ?        I<   08:57   0:00 [scsi_tmf_5]
    root         158  0.0  0.0      0     0 ?        I<   08:57   0:00 [scsi_tmf_4]
    root         159  0.0  0.0      0     0 ?        S    08:57   0:00 [scsi_eh_6]
    root         160  0.0  0.0      0     0 ?        I<   08:57   0:00 [scsi_tmf_6]
    root         161  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/u4:3-flush-254:0]
    root         162  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/u4:4-events_unbound]
    root         163  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/u4:5-flush-254:0]
    root         164  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/u4:6-events_unbound]
    root         165  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/u4:7-scsi_tmf_0]
    root         166  0.1  0.0      0     0 ?        I    08:57   0:00 [kworker/0:3-rcu_gp]
    root         168  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/0:4-cgroup_destroy]
    root         169  0.0  0.0      0     0 ?        I<   08:57   0:00 [kworker/1:2H-kblockd]
    root         208  0.0  0.0      0     0 ?        S    08:57   0:00 [jbd2/vda1-8]
    root         209  0.0  0.0      0     0 ?        I<   08:57   0:00 [ext4-rsv-conver]
    root         223  0.0  0.0      0     0 ?        S    08:57   0:00 [hwrng]
    root         251  0.3  0.8  41540 16272 ?        Ss   08:57   0:00 /lib/systemd/systemd-journald
    root         280  0.1  0.3  28232  7348 ?        Ss   08:57   0:00 /lib/systemd/systemd-udevd
    systemd+     297  0.0  0.3  90252  6952 ?        Ssl  08:57   0:00 /lib/systemd/systemd-timesyncd
    root         337  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/1:3-events]
    root         348  0.0  0.0      0     0 ?        S    08:57   0:00 [watchdogd]
    root         351  0.0  0.0      0     0 ?        I<   08:57   0:00 [cryptd]
    root         473  0.0  0.0      0     0 ?        I    08:57   0:00 [kworker/1:4-events]
    root         518  0.0  0.4 237640  9932 ?        Ssl  08:57   0:00 /usr/libexec/accounts-daemon
    avahi        520  0.0  0.1   8288  3980 ?        Ss   08:57   0:00 avahi-daemon: running [forense.local]
    root         521  0.0  0.0   6608  1200 ?        Ss   08:57   0:00 /usr/sbin/cron -f
    message+     522  0.3  0.3  10608  6156 ?        Ss   08:57   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
    root         524  0.0  0.2 230020  4420 ?        SLsl 08:57   0:00 /usr/libexec/low-memory-monitor
    polkitd      526  0.2  0.4 310756  9752 ?        Ssl  08:57   0:00 /usr/lib/polkit-1/polkitd --no-debug
    root         527  0.0  0.4 237268  9060 ?        Ssl  08:57   0:00 /usr/libexec/power-profiles-daemon
    root         528  0.0  0.0  80236  1880 ?        Ssl  08:57   0:00 /usr/sbin/qemu-ga
    root         529  0.0  0.4 233400  8792 ?        Ssl  08:57   0:00 /usr/libexec/switcheroo-control
    root         530  0.0  0.2 651308  5032 ?        Ssl  08:57   0:00 /usr/sbin/nscd
    root         531  0.1  0.3  17352  7904 ?        Ss   08:57   0:00 /lib/systemd/systemd-logind
    root         532  0.1  0.7 395040 14692 ?        Ssl  08:57   0:00 /usr/libexec/udisks2/udisksd
    avahi        533  0.0  0.0   8100   364 ?        S    08:57   0:00 avahi-daemon: chroot helper
    root         563  0.0  0.0      0     0 ?        S    08:57   0:00 [psimon]
    root         565  0.1  1.0 259328 20572 ?        Ssl  08:57   0:00 /usr/sbin/NetworkManager --no-daemon
    root         578  0.0  0.2  16532  5916 ?        Ss   08:57   0:00 /sbin/wpa_supplicant -u -s -O DIR=/run/wpa_supplicant GROUP=netdev
    root         580  0.0  0.6 317332 12216 ?        Ssl  08:57   0:00 /usr/sbin/ModemManager
    root         595  0.0  0.4  27080  8772 ?        Ss   08:57   0:00 /usr/sbin/cupsd -l
    lp           612  0.0  0.2  16592  5292 ?        S    08:57   0:00 /usr/lib/cups/notifier/dbus dbus://
    root         618  0.0  0.4  15648  8880 ?        Ss   08:57   0:00 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
    root         646  0.0  0.6 240808 13388 ?        Ssl  08:57   0:00 /usr/sbin/gdm3
    root         664  0.0  0.7 176520 14836 ?        Ssl  08:57   0:00 /usr/sbin/cups-browsed
    root         667  0.0  0.5 165576 10580 ?        Sl   08:57   0:00 gdm-session-worker [pam/gdm-launch-environment]
    root         670  0.0  1.4 221352 28876 ?        Ss   08:57   0:00 /usr/sbin/apache2 -k start
    Debian-+     675  0.1  0.5  19520 11180 ?        Ss   08:57   0:00 /lib/systemd/systemd --user
    Debian-+     676  0.0  0.1 103844  3284 ?        S    08:57   0:00 (sd-pam)
    www-data     677  0.0  0.5 221384 10828 ?        S    08:57   0:00 /usr/sbin/apache2 -k start
    www-data     678  0.0  0.5 221384 10828 ?        S    08:57   0:00 /usr/sbin/apache2 -k start
    www-data     679  0.0  0.5 221384 10828 ?        S    08:57   0:00 /usr/sbin/apache2 -k start
    www-data     680  0.0  0.5 221384 10828 ?        S    08:57   0:00 /usr/sbin/apache2 -k start
    www-data     681  0.0  0.5 221384 10828 ?        S    08:57   0:00 /usr/sbin/apache2 -k start
    Debian-+     696  0.0  0.5  44784 11756 ?        S<sl 08:57   0:00 /usr/bin/pipewire
    Debian-+     698  0.1  0.9 257744 18860 ?        S<sl 08:57   0:00 /usr/bin/wireplumber
    Debian-+     699  0.0  0.4 159464  8132 tty1     Ssl+ 08:57   0:00 /usr/libexec/gdm-wayland-session dbus-run-session -- gnome-session --autostart /usr/share/gdm/greeter/autostart
    Debian-+     700  0.0  0.4  27388  9204 ?        S<sl 08:57   0:00 /usr/bin/pipewire-pulse
    Debian-+     702  0.0  0.2   8460  4404 ?        Ss   08:57   0:00 /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
    Debian-+     704  0.0  0.0   6260  1512 tty1     S+   08:57   0:00 dbus-run-session -- gnome-session --autostart /usr/share/gdm/greeter/autostart
    rtkit        705  0.0  0.0  22912  1536 ?        SNsl 08:57   0:00 /usr/libexec/rtkit-daemon
    Debian-+     706  0.1  0.2   8784  4724 tty1     S+   08:57   0:00 dbus-daemon --nofork --print-address 4 --session
    Debian-+     708  0.1  1.0 791064 20288 tty1     Sl+  08:57   0:00 /usr/libexec/gnome-session-binary --autostart /usr/share/gdm/greeter/autostart
    Debian-+     713  0.0  0.4 237720  9904 ?        Ssl  08:57   0:00 /usr/libexec/gvfsd
    Debian-+     720  0.0  0.3 380372  6504 ?        Sl   08:57   0:00 /usr/libexec/gvfsd-fuse /run/user/112/gvfs -f
    Debian-+     746  2.4 10.6 3684276 214624 tty1   Sl+  08:57   0:00 /usr/bin/gnome-shell
    Debian-+     763  0.5  1.4 629672 28832 ?        SNsl 08:57   0:00 /usr/libexec/tracker-miner-fs-3
    Debian-+     769  0.0  0.3 311420  7712 tty1     Sl+  08:57   0:00 /usr/libexec/at-spi-bus-launcher
    Debian-+     774  0.0  0.2   8200  4084 tty1     S+   08:57   0:00 /usr/bin/dbus-daemon --config-file=/usr/share/defaults/at-spi2/accessibility.conf --nofork --print-address 11 --address=unix:path=/run/user/112/
    Debian-+     775  0.0  0.6 352120 13988 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-udisks2-volume-monitor
    Debian-+     783  0.0  0.5 312632 10176 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-afc-volume-monitor
    Debian-+     788  0.0  0.4 234492  8772 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-gphoto2-volume-monitor
    Debian-+     792  0.0  0.4 233536  8528 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-mtp-volume-monitor
    Debian-+     796  0.1  3.2 229120 65868 tty1     S+   08:57   0:00 /usr/bin/Xwayland :1024 -rootless -noreset -accessx -core -auth /run/user/112/.mutter-Xwaylandauth.BJFG12 -listenfd 4 -listenfd 5 -displayfd 6 -
    Debian-+     797  0.0  0.4 233728  8360 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-goa-volume-monitor
    Debian-+     801  0.1  2.1 672264 42588 ?        Sl   08:57   0:00 /usr/libexec/goa-daemon
    Debian-+     809  0.0  0.6 386620 13208 ?        Sl   08:57   0:00 /usr/libexec/goa-identity-service
    root         816  0.0  0.4 233880  8836 ?        Ssl  08:57   0:00 /usr/libexec/upowerd
    Debian-+     829  0.0  0.3 237000  7760 tty1     Sl+  08:57   0:00 /usr/libexec/xdg-permission-store
    geoclue      845  0.0  0.5 244848 12052 ?        Ssl  08:57   0:00 /usr/libexec/geoclue
    root         846  0.0  1.1 297952 22924 ?        Ssl  08:57   0:00 /usr/libexec/packagekitd
    Debian-+     853  0.0  1.3 2453060 26980 tty1    Sl+  08:57   0:00 /usr/bin/gjs /usr/share/gnome-shell/org.gnome.Shell.Notifications
    Debian-+     854  0.0  0.4 164320  9212 tty1     Sl+  08:57   0:00 /usr/libexec/at-spi2-registryd --use-gnome-session
    colord       855  0.1  0.8 242688 17764 ?        Ssl  08:57   0:00 /usr/libexec/colord
    Debian-+     860  0.0  0.6 463836 13168 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-sharing
    Debian-+     866  0.1  1.3 413520 27256 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-wacom
    Debian-+     875  0.1  1.2 340748 25664 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-color
    Debian-+     877  0.1  1.3 339096 26912 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-keyboard
    Debian-+     879  0.0  0.6 247660 13512 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-print-notifications
    Debian-+     881  0.0  0.5 454996 10592 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-rfkill
    Debian-+     885  0.0  0.6 312420 12192 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-smartcard
    Debian-+     887  0.0  0.6 355812 13988 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-datetime
    Debian-+     894  0.1  1.4 521828 29832 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-media-keys
    Debian-+     901  0.0  0.4 233412  8304 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-screensaver-proxy
    Debian-+     905  0.0  0.5 319940 11916 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-sound
    Debian-+     914  0.0  0.4 307928  8956 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-a11y-settings
    Debian-+     917  0.0  0.4 383220  9656 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-housekeeping
    Debian-+     925  0.1  1.4 451296 28624 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-power
    Debian-+    1019  0.0  0.8 342144 17684 tty1     Sl+  08:57   0:00 /usr/libexec/gsd-printer
    root        1042  0.0  0.5 242732 10624 ?        Ssl  08:57   0:00 /usr/libexec/realmd
    Debian-+    1053  0.0  0.6 312956 12384 tty1     Sl   08:57   0:00 ibus-daemon --panel disable -r --xim
    Debian-+    1058  0.0  1.3 2453056 27196 tty1    Sl+  08:57   0:00 /usr/bin/gjs /usr/share/gnome-shell/org.gnome.ScreenSaver
    Debian-+    1069  0.0  0.4 234488  9252 tty1     Sl   08:57   0:00 /usr/libexec/ibus-dconf
    Debian-+    1070  1.9  1.6 344492 32496 tty1     Sl   08:57   0:00 /usr/libexec/ibus-extension-gtk3
    Debian-+    1078  0.1  3.7 397600 74820 tty1     Sl   08:57   0:00 /usr/libexec/ibus-x11 --kill-daemon
    Debian-+    1083  0.0  0.4 234432  9536 tty1     Sl+  08:57   0:00 /usr/libexec/ibus-portal
    Debian-+    1096  0.0  0.3 160628  7148 tty1     Sl   08:57   0:00 /usr/libexec/ibus-engine-simple
    root        1100  0.2  0.5  18424 10960 ?        Ss   08:57   0:00 sshd: pablo [priv]
    pablo       1107  0.2  0.5  19528 11176 ?        Ss   08:57   0:00 /lib/systemd/systemd --user
    pablo       1109  0.0  0.1 104172  3524 ?        S    08:57   0:00 (sd-pam)
    pablo       1128  0.0  0.5  44692 11868 ?        Ssl  08:57   0:00 /usr/bin/pipewire
    pablo       1130  0.1  0.9 257736 19236 ?        Ssl  08:57   0:00 /usr/bin/wireplumber
    pablo       1136  0.0  0.4  26908  8760 ?        Ssl  08:57   0:00 /usr/bin/pipewire-pulse
    pablo       1143  0.0  0.3  18684  6636 ?        S    08:57   0:00 sshd: pablo@pts/0
    pablo       1144  0.0  0.2   8464  4384 ?        Ss   08:57   0:00 /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
    pablo       1150  0.0  0.4 237716  9904 ?        Ssl  08:57   0:00 /usr/libexec/gvfsd
    pablo       1162  0.0  0.3 380372  6612 ?        Sl   08:57   0:00 /usr/libexec/gvfsd-fuse /run/user/1000/gvfs -f
    pablo       1173  0.0  0.2   8444  4984 pts/0    Ss   08:57   0:00 -bash
    pablo       1178  0.6  3.8 634044 78296 ?        SNsl 08:57   0:00 /usr/libexec/tracker-miner-fs-3
    pablo       1183  0.0  0.6 352128 13872 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-udisks2-volume-monitor
    pablo       1188  0.0  0.5 312632 10192 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-afc-volume-monitor
    pablo       1193  0.0  0.4 234488  8776 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-gphoto2-volume-monitor
    pablo       1197  0.0  0.4 233532  8664 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-mtp-volume-monitor
    pablo       1201  0.0  0.4 233728  8648 ?        Ssl  08:57   0:00 /usr/libexec/gvfs-goa-volume-monitor
    pablo       1205  0.0  2.1 598536 42432 ?        Sl   08:57   0:00 /usr/libexec/goa-daemon
    pablo       1212  0.0  0.5 312888 10976 ?        Sl   08:57   0:00 /usr/libexec/goa-identity-service
    pablo       1234  200  0.2  11348  4416 pts/0    R+   08:58   0:00 ps -aux
    ```

2. Servicios en ejecución.

    ```bash
    pablo@forense:~$ systemctl list-units --type=service
    UNIT                               LOAD   ACTIVE SUB     DESCRIPTION                                   
    accounts-daemon.service            loaded active running Accounts Service
    alsa-restore.service               loaded active exited  Save/Restore Sound Card State
    apache2.service                    loaded active running The Apache HTTP Server
    apparmor.service                   loaded active exited  Load AppArmor profiles
    avahi-daemon.service               loaded active running Avahi mDNS/DNS-SD Stack
    colord.service                     loaded active running Manage, Install and Generate Color Profiles
    console-setup.service              loaded active exited  Set console font and keymap
    cron.service                       loaded active running Regular background program processing daemon
    cups-browsed.service               loaded active running Make remote CUPS printers available locally
    cups.service                       loaded active running CUPS Scheduler
    dbus.service                       loaded active running D-Bus System Message Bus
    gdm.service                        loaded active running GNOME Display Manager
    ifupdown-pre.service               loaded active exited  Helper to synchronize boot up for ifupdown
    keyboard-setup.service             loaded active exited  Set the console keyboard layout
    kmod-static-nodes.service          loaded active exited  Create List of Static Device Nodes
    low-memory-monitor.service         loaded active running Low Memory Monitor
    ModemManager.service               loaded active running Modem Manager
    networking.service                 loaded active exited  Raise network interfaces
    NetworkManager-wait-online.service loaded active exited  Network Manager Wait Online
    NetworkManager.service             loaded active running Network Manager
    nscd.service                       loaded active running Name Service Cache Daemon
    packagekit.service                 loaded active running PackageKit Daemon
    plymouth-quit-wait.service         loaded active exited  Hold until boot process finishes up
    plymouth-read-write.service        loaded active exited  Tell Plymouth To Write Out Runtime Data
    plymouth-start.service             loaded active exited  Show Plymouth Boot Screen
    polkit.service                     loaded active running Authorization Manager
    power-profiles-daemon.service      loaded active running Power Profiles daemon
    qemu-guest-agent.service           loaded active running QEMU Guest Agent
    rtkit-daemon.service               loaded active running RealtimeKit Scheduling Policy Service
    ssh.service                        loaded active running OpenBSD Secure Shell server
    switcheroo-control.service         loaded active running Switcheroo Control Proxy service
    systemd-binfmt.service             loaded active exited  Set Up Additional Binary Formats
    systemd-journal-flush.service      loaded active exited  Flush Journal to Persistent Storage
    systemd-journald.service           loaded active running Journal Service
    systemd-logind.service             loaded active running User Login Management
    systemd-modules-load.service       loaded active exited  Load Kernel Modules
    systemd-random-seed.service        loaded active exited  Load/Save Random Seed
    systemd-remount-fs.service         loaded active exited  Remount Root and Kernel File Systems
    systemd-sysctl.service             loaded active exited  Apply Kernel Variables
    systemd-sysusers.service           loaded active exited  Create System Users
    systemd-timesyncd.service          loaded active running Network Time Synchronization
    systemd-tmpfiles-setup-dev.service loaded active exited  Create Static Device Nodes in /dev
    systemd-tmpfiles-setup.service     loaded active exited  Create System Files and Directories
    systemd-udev-trigger.service       loaded active exited  Coldplug All udev Devices
    systemd-udevd.service              loaded active running Rule-based Manager for Device Events and Files
    systemd-update-utmp.service        loaded active exited  Record System Boot/Shutdown in UTMP
    systemd-user-sessions.service      loaded active exited  Permit User Sessions
    udisks2.service                    loaded active running Disk Manager
    upower.service                     loaded active running Daemon for power management
    user-runtime-dir@1000.service      loaded active exited  User Runtime Directory /run/user/1000
    user-runtime-dir@112.service       loaded active exited  User Runtime Directory /run/user/112
    user@1000.service                  loaded active running User Manager for UID 1000
    user@112.service                   loaded active running User Manager for UID 112
    wpa_supplicant.service             loaded active running WPA supplicant
    ```

3. Puertos abiertos.

    ```bash
    pablo@forense:~$ sudo netstat -tulpn
    Active Internet connections (only servers)
    Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
    tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      595/cupsd           
    tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      618/sshd: /usr/sbin 
    tcp6       0      0 :::80                   :::*                    LISTEN      670/apache2         
    tcp6       0      0 :::22                   :::*                    LISTEN      618/sshd: /usr/sbin 
    tcp6       0      0 ::1:631                 :::*                    LISTEN      595/cupsd           
    udp        0      0 0.0.0.0:5353            0.0.0.0:*                           520/avahi-daemon: r 
    udp        0      0 0.0.0.0:46385           0.0.0.0:*                           520/avahi-daemon: r 
    udp6       0      0 :::5353                 :::*                                520/avahi-daemon: r 
    udp6       0      0 :::58253                :::*                                520/avahi-daemon: r
    ```

4. Conexiones establecidas por la máquina.

    ```bash
    pablo@forense:~$ ss -ta
    State                      Recv-Q                  Send-Q                                     Local Address:Port                                      Peer Address:Port                   Process                  
    LISTEN                     0                       128                                            127.0.0.1:ipp                                            0.0.0.0:*                                               
    LISTEN                     0                       128                                              0.0.0.0:ssh                                            0.0.0.0:*                                               
    TIME-WAIT                  0                       0                                        192.168.122.134:55152                                   146.75.118.132:http                                            
    ESTAB                      0                       0                                        192.168.122.134:ssh                                      192.168.122.1:41756                                           
    LISTEN                     0                       511                                                    *:http                                                 *:*                                               
    LISTEN                     0                       128                                                 [::]:ssh                                               [::]:*                                               
    LISTEN                     0                       128                                                [::1]:ipp                                               [::]:* 
    ```

5. Sesiones de usuario establecidas remotamente.

    ```bash
    pablo@forense:~$ who -a
            arranque del sistema 2025-02-14 08:57
            `run-level' 5 2025-02-14 08:57
    pablo    + pts/0        2025-02-14 08:57   .          1100 (192.168.122.1)
            pts/1        2025-02-14 09:01              1295 id=ts/1  term=0 salida=0
    ```

6. Ficheros transferidos recientemente por NetBios.

    No existe NetBios en Debian.

7. Contenido de la caché DNS.

    ```bash
    pablo@forense:~$ sudo strings /var/cache/nscd/hosts
    localhost
    owave.
    localhost
    ip6-localhost
    ip6-loopback
    forense
    forense
    forense
    localhost
    localhost
    .net
    debian.map.fastlydns.net
    debian.map.fastlydns.net
    debian.map.fastlydns.net
    debian.map.fastlydns.net
    ipv4only.arpa
    ipv4only.arpa
    prod.remote-settings.prod.webservices.mozgcp.net
    firefox.settings.services.mozilla.com
    "$6P&
    ads-img.mozilla.org
    ads-img.mozilla.org
    muyinteresante.com
    www.muyinteresante.com
    theconversation.com
    theconversation.com
    pis.
    t0.gstatic.com
    t0.gstatic.com
    www.sleuthkit.org
    www.sleuthkit.org
    github.githubassets.com
    github.githubassets.com
    tic.
    avatars.githubusercontent.com
    avatars.githubusercontent.com
    user-images.githubusercontent.com
    user-images.githubusercontent.com
    objects.githubusercontent.com
    objects.githubusercontent.com
    firefox-api-proxy-prod.pocket.prod.cloudops.mozgcp.net
    firefox-api-proxy.cdn.mozilla.net
    debian.map.fastlydns.net
    debian.map.fastlydns.net
    debian.map.fastlydns.net
    debian.map.fastlydns.net
    github.com
    github.com
    cdn.
    t2.gstatic.com
    t2.gstatic.com
    t1.gstatic.com
    t1.gstatic.com
    cdn.
    sleuthkit.hosted-by-discourse.com
    sleuthkit.discourse.group
    t1.gstatic.com
    t1.gstatic.com
    cdn.
    sleuthkit.hosted-by-discourse.com
    sleuthkit.discourse.group
    t1.gstatic.com
    t1.gstatic.com
    cdn.
    sleuthkit.hosted-by-discourse.com
    sleuthkit.discourse.group
    sleuthkit.hosted-by-discourse.com
    sleuthkit.discourse.group
    t1.gstatic.com
    t1.gstatic.com
    cdn.
    ocsp.comodoca.com.cdn.cloudflare.net
    ocsp.sectigo.com
    wp.wpenginepowered.com
    www.autopsy.com
    aistati
    wp.wpenginepowered.com
    www.autopsy.com
    ....
    ```

8. Variables de entorno.

    ```bash
    pablo@forense:~$ printenv
    SHELL=/bin/bash
    PWD=/home/pablo
    LOGNAME=pablo
    XDG_SESSION_TYPE=tty
    MOTD_SHOWN=pam
    HOME=/home/pablo
    LANG=es_ES.UTF-8
    LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=00:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.avif=01;35:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:*~=00;90:*#=00;90:*.bak=00;90:*.old=00;90:*.orig=00;90:*.part=00;90:*.rej=00;90:*.swp=00;90:*.tmp=00;90:*.dpkg-dist=00;90:*.dpkg-old=00;90:*.ucf-dist=00;90:*.ucf-new=00;90:*.ucf-old=00;90:*.rpmnew=00;90:*.rpmorig=00;90:*.rpmsave=00;90:
    SSH_CONNECTION=192.168.122.1 41756 192.168.122.134 22
    XDG_SESSION_CLASS=user
    TERM=xterm-256color
    USER=pablo
    SHLVL=1
    XDG_SESSION_ID=2
    XDG_RUNTIME_DIR=/run/user/1000
    SSH_CLIENT=192.168.122.1 41756 22
    XDG_DATA_DIRS=/usr/share/gnome:/usr/local/share/:/usr/share/
    PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
    DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus
    SSH_TTY=/dev/pts/0
    _=/usr/bin/printenv
    ```

9. Dispositivos USB conectados

    ```bash
    pablo@forense:~$ lsusb
    Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
    Bus 001 Device 002: ID 0627:0001 Adomax Technology Co., Ltd QEMU Tablet
    Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
    ```


10. Redes wifi utilizadas recientemente.

    ```bash
    pablo@forense:~$ nmcli c show --active
    NAME                UUID                                  TYPE      DEVICE 
    Wired connection 1  8fcaf683-6d5c-4944-bd2f-5f9be35c0a36  ethernet  enp1s0 
    lo                  77238d91-b61a-41c7-8df5-b3b3e3fc8122  loopback  lo     
    pablo@forense:~$ nmcli c show
    NAME                UUID                                  TYPE      DEVICE 
    Wired connection 1  8fcaf683-6d5c-4944-bd2f-5f9be35c0a36  ethernet  enp1s0 
    lo                  77238d91-b61a-41c7-8df5-b3b3e3fc8122  loopback  lo
    ```

11. Configuración del firewall de nodo.

    ```bash
    pablo@forense:~$ sudo iptables -L
    Chain INPUT (policy ACCEPT)
    target     prot opt source               destination         

    Chain FORWARD (policy ACCEPT)
    target     prot opt source               destination         

    Chain OUTPUT (policy ACCEPT)
    target     prot opt source               destination
    ```

12. Programas que se ejecutan en el Inicio.

    ```bash
    pablo@forense:~$ systemctl list-unit-files --type=service | grep enabled
    accounts-daemon.service                    enabled         enabled
    alsa-utils.service                         masked          enabled
    anacron.service                            enabled         enabled
    apache-htcacheclean.service                disabled        enabled
    apache-htcacheclean@.service               disabled        enabled
    apache2.service                            enabled         enabled
    apache2@.service                           disabled        enabled
    apparmor.service                           enabled         enabled
    avahi-daemon.service                       enabled         enabled
    bluetooth.service                          enabled         enabled
    console-setup.service                      enabled         enabled
    cron.service                               enabled         enabled
    cryptdisks-early.service                   masked          enabled
    cryptdisks.service                         masked          enabled
    cups-browsed.service                       enabled         enabled
    cups.service                               enabled         enabled
    e2scrub_reap.service                       enabled         enabled
    getty@.service                             enabled         enabled
    hwclock.service                            masked          enabled
    ifupdown-wait-online.service               disabled        enabled
    keyboard-setup.service                     enabled         enabled
    low-memory-monitor.service                 enabled         enabled
    ModemManager.service                       enabled         enabled
    networking.service                         enabled         enabled
    NetworkManager-dispatcher.service          enabled         enabled
    NetworkManager-wait-online.service         enabled         enabled
    NetworkManager.service                     enabled         enabled
    nftables.service                           disabled        enabled
    nscd.service                               enabled         enabled
    power-profiles-daemon.service              enabled         enabled
    rc.service                                 masked          enabled
    rcS.service                                masked          enabled
    rtkit-daemon.service                       disabled        enabled
    saned.service                              masked          enabled
    saned@.service                             indirect        enabled
    serial-getty@.service                      disabled        enabled
    speech-dispatcherd.service                 disabled        enabled
    ssh.service                                enabled         enabled
    sudo.service                               masked          enabled
    switcheroo-control.service                 enabled         enabled
    systemd-fsck-root.service                  enabled-runtime enabled
    systemd-network-generator.service          disabled        enabled
    systemd-networkd-wait-online@.service      disabled        enabled
    systemd-networkd.service                   disabled        enabled
    systemd-pstore.service                     enabled         enabled
    systemd-remount-fs.service                 enabled-runtime enabled
    systemd-sysext.service                     disabled        enabled
    systemd-timesyncd.service                  enabled         enabled
    udisks2.service                            enabled         enabled
    upower.service                             disabled        enabled
    wpa_supplicant-nl80211@.service            disabled        enabled
    wpa_supplicant-wired@.service              disabled        enabled
    wpa_supplicant.service                     enabled         enabled
    wpa_supplicant@.service                    disabled        enabled
    x11-common.service                         masked          enabled
    ```

13. Asociación de extensiones de ficheros y aplicaciones.

    ```bash
    pablo@forense:~$ cat /usr/share/applications/mimeinfo.cache
    [MIME Cache]
    application/bzip2=org.gnome.FileRoller.desktop;org.gnome.Nautilus.desktop;
    application/clarisworks=libreoffice-calc.desktop;libreoffice-draw.desktop;libreoffice-writer.desktop;
    application/csv=libreoffice-calc.desktop;
    application/excel=libreoffice-calc.desktop;
    application/gpx+xml=org.gnome.Maps.desktop;
    application/gzip=org.gnome.FileRoller.desktop;org.gnome.Nautilus.desktop;
    application/illustrator=org.gnome.Evince.desktop;
    application/macwriteii=libreoffice-writer.desktop;
    application/mathml+xml=libreoffice-math.desktop;
    application/mbox=org.gnome.Evolution.desktop;
    application/msexcel=libreoffice-calc.desktop;
    application/mspowerpoint=libreoffice-impress.desktop;
    application/msword=libreoffice-writer.desktop;
    application/mxf=org.gnome.Totem.desktop;
    application/ogg=org.gnome.Rhythmbox3.desktop;
    application/oxps=org.gnome.Evince.desktop;
    application/pdf=libreoffice-draw.desktop;org.gnome.Evince.desktop;
    application/pgp-keys=org.gnome.seahorse.Application.desktop;
    application/pkcs10=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkcs10+pem=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkcs12=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkcs12+pem=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkcs7-mime=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkcs7-mime+pem=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkcs8=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkcs8+pem=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkix-cert=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkix-cert+pem=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkix-crl=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/pkix-crl+pem=gcr-viewer.desktop;org.gnome.seahorse.Application.desktop;
    application/postscript=org.gnome.Evince.desktop;
    application/prs.plucker=libreoffice-writer.desktop;
    application/ram=org.gnome.Totem.desktop;
    application/rdf+xml=firefox-esr.desktop;
    application/rss+xml=firefox-esr.desktop;
    application/rtf=libreoffice-writer.desktop;
    application/sdp=org.gnome.Totem.desktop;
    application/smil=org.gnome.Totem.desktop;
    application/smil+xml=org.gnome.Totem.desktop;
    application/tab-separated-values=libreoffice-calc.desktop;
    application/vnd.android.package-archive=org.gnome.FileRoller.desktop;
    application/vnd.apple.mpegurl=org.gnome.Totem.desktop;
    application/vnd.comicbook+zip=org.gnome.Evince.desktop;
    application/vnd.comicbook-rar=org.gnome.Evince.desktop;
    application/vnd.corel-draw=libreoffice-draw.desktop;
    application/vnd.debian.binary-package=org.gnome.FileRoller.desktop;
    application/vnd.flatpak=gnome-software-local-file-flatpak.desktop;
    application/vnd.flatpak.ref=gnome-software-local-file-flatpak.desktop;
    application/vnd.flatpak.repo=gnome-software-local-file-flatpak.desktop;
    application/vnd.geo+json=org.gnome.Maps.desktop;
    application/vnd.google-earth.kml+xml=org.gnome.Maps.desktop;
    application/vnd.iccprofile=gcm-import.desktop;
    application/vnd.lotus-1-2-3=libreoffice-calc.desktop;
    application/vnd.lotus-wordpro=libreoffice-writer.desktop;
    application/vnd.mozilla.xul+xml=firefox-esr.desktop;
    application/vnd.ms-asf=org.gnome.Totem.desktop;
    application/vnd.ms-cab-compressed=gnome-software-local-file-fwupd.desktop;org.gnome.FileRoller.desktop;
    application/vnd.ms-excel=libreoffice-calc.desktop;
    application/vnd.ms-excel.sheet.binary.macroEnabled.12=libreoffice-calc.desktop;
    application/vnd.ms-excel.sheet.macroEnabled.12=libreoffice-calc.desktop;
    application/vnd.ms-excel.template.macroEnabled.12=libreoffice-calc.desktop;
    application/vnd.ms-powerpoint=libreoffice-impress.desktop;
    application/vnd.ms-powerpoint.presentation.macroEnabled.12=libreoffice-impress.desktop;
    application/vnd.ms-powerpoint.slideshow.macroEnabled.12=libreoffice-impress.desktop;
    application/vnd.ms-powerpoint.template.macroEnabled.12=libreoffice-impress.desktop;
    application/vnd.ms-publisher=libreoffice-draw.desktop;
    application/vnd.ms-word=libreoffice-writer.desktop;
    application/vnd.ms-word.document.macroEnabled.12=libreoffice-writer.desktop;
    application/vnd.ms-word.template.macroEnabled.12=libreoffice-writer.desktop;
    application/vnd.ms-works=libreoffice-calc.desktop;libreoffice-writer.desktop;
    application/vnd.ms-wpl=org.gnome.Totem.desktop;
    .....
    ```

14. Aplicaciones usadas recientemente.

    ```bash
    pablo@forense:~$ history | awk '{print $2}' | sort | uniq -c | sort -nr | head
        89 sudo
        25 clear
        19 ls
        14 cd
        6 dpkg
        5 ss
        5 export
        4 java
    ```

15. Ficheros abiertos recientemente.

    ```bash
    pablo@forense:~$ sudo lsof
    ....
    lsof      1427                            root  cwd       DIR              254,1      4096     265581 /home/pablo
    lsof      1427                            root  rtd       DIR              254,1      4096          2 /
    lsof      1427                            root  txt       REG              254,1    179824     803700 /usr/bin/lsof
    lsof      1427                            root  mem       REG              254,1   3048800     797691 /usr/lib/locale/locale-archive
    lsof      1427                            root  mem       REG              254,1     60328     784887 /usr/lib/x86_64-linux-gnu/libresolv.so.2
    lsof      1427                            root  mem       REG              254,1     22448     788949 /usr/lib/x86_64-linux-gnu/libkeyutils.so.1.10
    lsof      1427                            root  mem       REG              254,1     52224     788939 /usr/lib/x86_64-linux-gnu/libkrb5support.so.0.1
    lsof      1427                            root  mem       REG              254,1     18344     785052 /usr/lib/x86_64-linux-gnu/libcom_err.so.2.1
    lsof      1427                            root  mem       REG              254,1    183048     788944 /usr/lib/x86_64-linux-gnu/libk5crypto.so.3.1
    lsof      1427                            root  mem       REG              254,1    888080     788962 /usr/lib/x86_64-linux-gnu/libkrb5.so.3.3
    lsof      1427                            root  mem       REG              254,1    629384     783985 /usr/lib/x86_64-linux-gnu/libpcre2-8.so.0.11.2
    lsof      1427                            root  mem       REG              254,1    338680     790065 /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.2.2
    lsof      1427                            root  mem       REG              254,1   1922136     784696 /usr/lib/x86_64-linux-gnu/libc.so.6
    lsof      1427                            root  mem       REG              254,1    174312     785595 /usr/lib/x86_64-linux-gnu/libselinux.so.1
    lsof      1427                            root  mem       REG              254,1    186832     791056 /usr/lib/x86_64-linux-gnu/libtirpc.so.3.0.0
    lsof      1427                            root  mem       REG              254,1    210904     784693 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    lsof      1427                            root    4r     FIFO               0,13       0t0      23231 pipe
    lsof      1427                            root    7w     FIFO               0,13       0t0      23232 pipe
    ```

16. Software Instalado.

    ```bash
    pablo@forense:~$ sudo dpkg -l
    ||/ Nombre                                  Versión                             Arquitectura Descripción
    +++-=======================================-===================================-============-================================================================================
    ii  accountsservice                         22.08.8-6                           amd64        query and manipulate user account information
    ii  acl                                     2.3.1-3                             amd64        access control list - utilities
    ii  adduser                                 3.134                               all          add and remove users and groups
    ii  adwaita-icon-theme                      43-1                                all          default icon theme of GNOME
    ii  afflib-tools                            3.7.20-1                            amd64        Advanced Forensics Format Library (utilities)
    ii  aisleriot                               1:3.22.23-1                         amd64        GNOME solitaire card game collection
    ii  alsa-topology-conf                      1.2.5.1-2                           all          ALSA topology configuration files
    ii  alsa-ucm-conf                           1.2.8-1                             all          ALSA Use Case Manager configuration files
    ii  alsa-utils                              1.2.8-1                             amd64        Utilities for configuring and using ALSA
    ii  amd64-microcode                         3.20240820.1~deb12u1                amd64        Platform firmware and microcode for AMD CPUs and SoCs
    ii  anacron                                 2.3-36                              amd64        cron-like program that doesn't go by time
    ii  ant                                     1.10.13-1                           all          Java based build tool like make
    ii  ant-optional                            1.10.13-1                           all          Java based build tool like make - optional libraries
    ii  apache2                                 2.4.62-1~deb12u2                    amd64        Apache HTTP Server
    ii  apache2-bin                             2.4.62-1~deb12u2                    amd64        Apache HTTP Server (modules and other binary files)
    ii  apache2-data                            2.4.62-1~deb12u2                    all          Apache HTTP Server (common files)
    ii  apache2-utils                           2.4.62-1~deb12u2                    amd64        Apache HTTP Server (utility programs for web servers)
    ii  apg                                     2.2.3.dfsg.1-5+b2                   amd64        Automated Password Generator - Standalone version
    ii  apparmor                                3.0.8-3                             amd64        user-space parser utility for AppArmor
    ii  appstream                               0.16.1-2                            amd64        Software component metadata management
    ii  apt                                     2.6.1                               amd64        commandline package manager
    ii  apt-config-icons                        0.16.1-2                            all          APT configuration snippet to enable icon downloads
    ii  apt-listchanges                         3.24                                all          package change history notification tool
    ii  apt-utils                               2.6.1                               amd64        package management related utility programs
    ii  aspell                                  0.60.8-4+b1                         amd64        GNU Aspell spell-checker
    ii  aspell-es                               1.11-20                             all          Spanish dictionary for aspell
    ii  at-spi2-common                          2.46.0-5                            all          Assistive Technology Service Provider Interface (common files)
    ii  at-spi2-core                            2.46.0-5                            amd64        Assistive Technology Service Provider Interface (D-Bus core)
    ii  avahi-daemon                            0.8-10+deb12u1                      amd64        Avahi mDNS/DNS-SD daemon
    ii  baobab                                  43.0-1                              amd64        GNOME disk usage analyzer
    ii  base-files                              12.4+deb12u9                        amd64        Debian base system miscellaneous files
    ii  base-passwd                             3.6.1                               amd64        Debian base system master password and group files
    ii  bash                                    5.2.15-2+b7                         amd64        GNU Bourne Again SHell
    ```

17. Contraseñas guardadas.

    ```bash
    pablo@forense:~$ sudo cat /etc/shadow
    root:$y$j9T$Chb8fAS.YcHKcL5R1.UuL.$QghyEAV6vIH9ovW9AA4zYnAfNCg/I1wcDK6Fi0CFCEA:20132:0:99999:7:::
    daemon:*:20132:0:99999:7:::
    bin:*:20132:0:99999:7:::
    sys:*:20132:0:99999:7:::
    sync:*:20132:0:99999:7:::
    games:*:20132:0:99999:7:::
    man:*:20132:0:99999:7:::
    lp:*:20132:0:99999:7:::
    mail:*:20132:0:99999:7:::
    news:*:20132:0:99999:7:::
    uucp:*:20132:0:99999:7:::
    proxy:*:20132:0:99999:7:::
    www-data:*:20132:0:99999:7:::
    backup:*:20132:0:99999:7:::
    list:*:20132:0:99999:7:::
    irc:*:20132:0:99999:7:::
    _apt:*:20132:0:99999:7:::
    nobody:*:20132:0:99999:7:::
    systemd-network:!*:20132::::::
    tss:!:20132::::::
    systemd-timesync:!*:20132::::::
    messagebus:!:20132::::::
    usbmux:!:20132::::::
    sshd:!:20132::::::
    dnsmasq:!:20132::::::
    avahi:!:20132::::::
    speech-dispatcher:!:20132::::::
    fwupd-refresh:!:20132::::::
    saned:!:20132::::::
    geoclue:!:20132::::::
    polkitd:!*:20132::::::
    rtkit:!:20132::::::
    colord:!:20132::::::
    gnome-initial-setup:!:20132::::::
    Debian-gdm:!:20132::::::
    pablo:$y$j9T$G.NSU/fZ4YKOk5oWQV5un.$YPw9I3pAIA1fqI8jiVZYfum1UYHDtx.QKDQWz7ZKjn3:20132:0:99999:7:::
    ```

18. Cuentas de Usuario

    ```bash
    pablo@forense:~$ sudo cat /etc/passwd
    root:x:0:0:root:/root:/bin/bash
    daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
    bin:x:2:2:bin:/bin:/usr/sbin/nologin
    sys:x:3:3:sys:/dev:/usr/sbin/nologin
    sync:x:4:65534:sync:/bin:/bin/sync
    games:x:5:60:games:/usr/games:/usr/sbin/nologin
    man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
    lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
    mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
    news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
    uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
    proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
    www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
    backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
    list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
    irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
    _apt:x:42:65534::/nonexistent:/usr/sbin/nologin
    nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
    systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
    tss:x:100:107:TPM software stack,,,:/var/lib/tpm:/bin/false
    systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin
    messagebus:x:101:108::/nonexistent:/usr/sbin/nologin
    usbmux:x:102:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
    sshd:x:103:65534::/run/sshd:/usr/sbin/nologin
    dnsmasq:x:999:65534:dnsmasq:/var/lib/misc:/usr/sbin/nologin
    avahi:x:104:112:Avahi mDNS daemon,,,:/run/avahi-daemon:/usr/sbin/nologin
    speech-dispatcher:x:105:29:Speech Dispatcher,,,:/run/speech-dispatcher:/bin/false
    fwupd-refresh:x:106:115:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
    saned:x:107:117::/var/lib/saned:/usr/sbin/nologin
    geoclue:x:108:118::/var/lib/geoclue:/usr/sbin/nologin
    polkitd:x:996:996:polkit:/nonexistent:/usr/sbin/nologin
    rtkit:x:109:119:RealtimeKit,,,:/proc:/usr/sbin/nologin
    colord:x:110:120:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin
    gnome-initial-setup:x:111:65534::/run/gnome-initial-setup/:/bin/false
    Debian-gdm:x:112:121:Gnome Display Manager:/var/lib/gdm3:/bin/false
    pablo:x:1000:1000:pablo,,,:/home/pablo:/bin/bash
    ```

19. Historial de navegación y descargas. Cookies.

20. Volúmenes cifrados

    ```bash
    pablo@forense:~$ sudo find / -type f -name "*.gpg"
    /usr/share/gnupg/distsigkey.gpg
    /usr/share/keyrings/debian-archive-bullseye-automatic.gpg
    /usr/share/keyrings/debian-archive-bookworm-security-automatic.gpg
    /usr/share/keyrings/debian-archive-bookworm-stable.gpg
    /usr/share/keyrings/debian-archive-bullseye-security-automatic.gpg
    /usr/share/keyrings/debian-archive-removed-keys.gpg
    /usr/share/keyrings/debian-archive-keyring.gpg
    /usr/share/keyrings/debian-archive-buster-stable.gpg
    /usr/share/keyrings/debian-archive-bullseye-stable.gpg
    /usr/share/keyrings/debian-archive-buster-security-automatic.gpg
    /usr/share/keyrings/debian-archive-bookworm-automatic.gpg
    /usr/share/keyrings/debian-archive-buster-automatic.gpg
    find: ‘/run/user/1000/gvfs’: Permiso denegado
    find: ‘/run/user/112/gvfs’: Permiso denegado
    /var/lib/fwupd/gnupg/trustdb.gpg
    /home/pablo/.gnupg/trustdb.gpg
    ```

21. Archivos con extensión cambiada.

22. Archivos eliminados.

23. Archivos Ocultos.

24. Archivos que contienen una cadena determinada.

25. Búsqueda de imágenes por ubicación.

26. Búsqueda de archivos por autor.